# トラブルシューティング

## よくある問題と解決方法

### 1. カレンダーが表示されない

#### 症状
- アプリを開いても「表示可能なカレンダーがありません」と表示される
- ローディングが終わらない

#### 解決方法
1. **Calendar APIが有効になっているか確認**
   - Google Apps Scriptの左サイドバー「サービス」
   - Calendar API v3が追加されているか確認

2. **設定を確認**
   - code.gsのCONFIG設定が正しいか確認
   - カレンダーIDが正確か確認

3. **権限を確認**
   - ログインユーザーが対象カレンダーにアクセス権限を持っているか確認

### 2. 組織単位（OU）が認識されない

#### 症状
- Google Workspace環境なのに個人カレンダーしか表示されない
- 部署のカレンダーが表示されない

#### 解決方法
1. **AdminDirectory APIが有効になっているか確認**
   - Google Apps Scriptの「サービス」でAdminDirectory APIを追加

2. **設定を確認**
   - `USE_GOOGLE_WORKSPACE: true` になっているか確認
   - OU_TO_CALENDAR設定が正しいか確認

3. **管理者権限を確認**
   - AdminDirectory APIを使用するには管理者権限が必要
   - Google Workspace管理者に権限付与を依頼

### 3. 予定作成ボタンが動作しない

#### 症状
- ＋ボタンをクリックしても新しい予定作成画面が開かない
- エラーメッセージが表示される

#### 解決方法
1. **ポップアップブロッカーを確認**
   - ブラウザのポップアップブロッカーを無効にする
   - 当該サイトを許可リストに追加

2. **カレンダーへの書き込み権限を確認**
   - 対象カレンダーに予定作成権限があるか確認

### 4. エラーメッセージの詳細

#### "Script function not found: loadInitialData"
- code.gsファイルが正しく保存されていない
- 関数名にタイプミスがある
- ファイルを再保存して再デプロイ

#### "Exception: Rate limit exceeded"
- Google Calendar APIの呼び出し制限に達している
- しばらく待ってから再試行
- 大量のカレンダー表示を避ける

#### "Exception: Access denied"
- 権限が不足している
- アプリの権限設定を再確認
- 必要に応じて管理者に権限を依頼

### 5. パフォーマンスの問題

#### 症状
- ページ読み込みが遅い
- カレンダー切り替えに時間がかかる

#### 解決方法
1. **表示カレンダー数を削減**
   - 不要なカレンダーをCONFIGから削除
   - 表示期間を短縮

2. **キャッシュの活用**
   - ブラウザのキャッシュを有効にする
   - 頻繁な画面更新を避ける

### 6. モバイル表示の問題

#### 症状
- スマートフォンで表示が崩れる
- タッチ操作が効かない

#### 解決方法
1. **ブラウザの更新**
   - 最新版のブラウザを使用
   - Chromeまたは Safari推奨

2. **画面サイズ**
   - 横向き表示を試す
   - ズーム設定を確認

### 7. 権限エラーの解決

#### 初回アクセス時の権限承認手順
1. 「このアプリは確認されていません」画面が表示
2. 「詳細」をクリック
3. 「安全ではないページに移動」をクリック
4. 必要な権限を確認して「許可」

#### 権限の再設定
1. Google アカウント設定を開く
2. 「セキュリティ」→「サードパーティアプリのアクセス」
3. 該当アプリを削除
4. アプリに再度アクセスして権限を再承認

### 8. デバッグ方法

#### ブラウザの開発者ツールを使用
1. F12キーで開発者ツールを開く
2. 「Console」タブでエラーメッセージを確認
3. ネットワークタブでAPI呼び出しを確認

#### Google Apps Scriptのログ確認
1. Apps Scriptエディタの「実行」タブ
2. 実行ログでエラーの詳細を確認

## サポート情報

### 問い合わせ先
- GitHub Issues: バグ報告や機能要望
- Google Apps Script公式ドキュメント
- Google Calendar API ドキュメント

### 参考リンク
- [Google Apps Script公式](https://developers.google.com/apps-script)
- [Google Calendar API](https://developers.google.com/calendar/api)
- [Admin Directory API](https://developers.google.com/admin-sdk/directory)
